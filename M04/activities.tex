\subsection{Activities}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Raspberry Pi - Install new vision dependencies}
\begin{itemize}
	\item Dependencies to run vision code were installed to the raspberry.
	\item Line detection CPU code was compiled and run.
	\item Optimizations are still needed but frame-reading from the cameras must be completed first to know which are the best options.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Raspberry Pi - SPI reception of images}
\begin{itemize}
	\item Code was started to receive and manage the data from the STM32.
	\item Maximum possible transfer speed was experimentally found to be around 43 MHz.
	\begin{itemize}
		\item STM32 datasheet states its maximum SPI transfer speed is 45 Mbits/s.
		\item Raspberry Pi can transfer up to 125 Mbits/s.
		\item The next Pi "step" goes beyond STM32 transfer limit and fails.
	\end{itemize}
	\item This is scheduled (Gantt) to be finished next week.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{STM32 - DCMI}
\begin{itemize}
	\item DCMI controller was programmed and used successfully.
	\item Pin options were found to avoid conflicts with wired but not used peripherals and with the required ones (see next section).
	\item This was a crucial part of the development because it allows to get frames off the camera using only hardware.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{STM32 - Pin selection}
\begin{itemize}
	\item The 32F429IDISCOVERY board has some peripherals soldered to pins used by the DCMI controller and the high speed SPI peripherals.
	\item These conflicts had to be addressed to be able to safely use these required features.
	\item The microcontroller has options for many of the required DCMI signals.
	\begin{itemize}
		\item Table \ref{tab_boardpin_dcmi} shows the DCMI signals of interest and the pins they could be mapped to.
		\item The board column shows the peripheral the corresponding pin is soldered to at the discovery board.
		\item It can be seen there are no free options for every signal, thus the LCD peripheral can not be used simultaneously. 
	\end{itemize}
\end{itemize}
\input{tab/boardpin_dcmi.tex}
\begin{itemize}
	\item Table \ref{tab_boardpin_dcmi_conflict} shows the signal the chosen conflicted pins carry.
	\begin{itemize}
		\item It can be seen that there is an input pin and some inputs/outputs ones.
		\item The only LCD datasheet available is very poor.
		\item It does not explicitly state what happens with those pins if you disable the screen (using its EN input).
		\item It does not states in which circumstances the DX pins behave as outputs.
		\item These lines behave as inputs when running the LCD example code.
		\item The LCD was disabled and no situation was found for any of these pins behaving as outputs.
	\end{itemize}

\end{itemize}

\input{tab/boardpin_dcmi_conflict.tex}

\begin{itemize}
	\item High speed SPI peripheral were also:
	\begin{itemize}
		\item already soldered to something or
		\item their pins were used by the DCMI controller.
	\end{itemize}
	\item High speed SPI instances are SPI1, SPI 4 (table \ref{tab_boardpin_spi_a}), SPI5 and SPI6 (table \ref{tab_boardpin_spi_b}).
	\item Conflicts can be seen on these tables.
	\item The only option that does not conflict with SDRAM nor DCMI is SPI5.
\end{itemize}


\input{tab/boardpin_spi_a.tex}
\input{tab/boardpin_spi_b.tex}

\begin{itemize}
	\item SPI was easier to address because it is actually a SPI feature to allow connection of multiple slaves. 
	\item The only action taken to ensure there were no conflicts was to pull the chip/slave select signal of the two connected peripherals (table \ref{tab_boardpin_spi5_conflict}) up.
\end{itemize}

\input{tab/boardpin_spi5_conflict.tex}

\begin{itemize}
	\item All the pins involved with the interfacing of the camera and the Raspberry are shown at table \ref{tab_boardpin_final}. 
	\item MCO is the peripheral used to generate clock signals out of the microcontroller oscillators
	\begin{itemize}
		\item It is used as the camera's clock signal.
	\end{itemize}
\end{itemize}
\input{tab/boardpin_final.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{General-purpose computing on graphics processing units}
\begin{itemize}
	\item Finished study of OpenGL ES 2.0 features of interest.
	\item A very interesting point is that WebGL (OpenGL implementation included in most moder web browsers) is based on OpenGL ES 2.0.
	\item This was used to validate earned knowledge knowing code would be easily ported to the Raspberry Pi.
	\item GPU code for Gauss and Sobel filters was developed and tested.
	\item Limitations were found but there is no way to meassure their impact without having the frame reception code ready.
\end{itemize}

